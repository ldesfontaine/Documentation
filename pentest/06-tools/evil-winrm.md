# Evil-WinRM Guide

Evil-WinRM is a powerful tool for Windows Remote Management that allows penetration testers to gain access to Windows systems. This guide covers installation, usage, file handling, a CTF workflow, and comparisons with Impacket tools.

## Installation
Evil-WinRM can be installed using Ruby's package manager, RubyGems. Here's how you can install it:

```bash
# Ensure you have Ruby installed
gem install evil-winrm
```

## Usage with Passwords and NTLM Hashes
Evil-WinRM supports password authentication and NTLM hash authentication. 

### Using a Password

```bash
evil-winrm -i <target-ip> -u <username> -p <password>
```

### Using NTLM Hashes

To authenticate with NTLM hashes, use the `-H` option:

```bash
evil-winrm -i <target-ip> -u <username> -H <NTLM-hash>
```

### Example
```bash
evil-winrm -i 192.168.1.10 -u Administrator -p P@ssw0rd
# or using NTLM hash
evil-winrm -i 192.168.1.10 -u Administrator -H abcdef1234567890
```

## File Upload/Download
Evil-WinRM allows for file uploads and downloads using the following commands:

### Uploading a File
```bash
upload /path/to/local/file C:\path\to\remote\file
```

### Downloading a File
```bash
download C:\path\to\remote\file /path/to/local/file
```

## Complete CTF Workflow
1. **Reconnaissance**: Gather information about the target system to understand the environment.
2. **Finding Access**: Use password or NTLM hash to connect with Evil-WinRM.
3. **Maintaining Access**: Always maintain access using appropriate techniques.
4. **Privilege Escalation**: Once connected, explore for ways to escalate privileges.
5. **Post-Exploitation**: Understand your target further after gaining access.

## Comparison with Impacket Tools
- **Evil-WinRM**: Focused solely on Windows systems with a straightforward interface.
- **Impacket**: A suite of tools that provides a wider range of capabilities, including NTLM relay and SMB attacks, but can be more complex to use.

## Examples
Attempting a connection:
```bash
evil-winrm -i 192.168.1.10 -u Administrator -p P@ssw0rd
```
Uploading a file:
```bash
upload /tmp/example.txt C:\examples\example.txt
```
