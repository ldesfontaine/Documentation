# ðŸ“ Ã‰numÃ©ration SMB/Samba

[ðŸ  Accueil](../README.md) | [ðŸŒ HTTP](http-web.md) | [ðŸ“‚ FTP](ftp.md) | [ðŸ” SSH](ssh.md) | [ðŸ—„ï¸ MySQL](mysql.md) | [ðŸ“§ SMTP](smtp.md) | [ðŸ“¤ WebDAV](webdav.md)

## Port par dÃ©faut : 445

## Nmap Scripts SMB
```bash
nmap -p445 --script smb-protocols targetIP
nmap -p445 --script smb-security-mode targetIP
nmap -p445 --script smb-enum-sessions targetIP
nmap -p445 --script smb-enum-shares targetIP
nmap --script smb-os-discovery.nse -p 445 targetIP
```

## Metasploit Modules
```bash
use scanner/smb/smb_enumusers
use scanner/smb/smb_login
    set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
    set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
use auxiliary/scanner/smb/smb_enumshares
use auxiliary/scanner/smb/smb_version
```

## Sessions anonymes
```bash
smbclient -L targetIP -N
rpcclient -U "" -N targetIP
```

## Enum4linux
```bash
enum4linux -a targetIP
```

## Script de bruteforce des shares
```bash
#!/bin/bash
TARGET="targetIP"
WORDLIST="/root/Desktop/wordlists/shares.txt"

if [ ! -f "$WORDLIST" ]; then
    echo "Wordlist not found: $WORDLIST"
    exit 1
fi

while read -r SHARE; do
    echo "Testing share: $SHARE"
    smbclient //$TARGET/$SHARE -N -c "ls" &>/dev/null
    
    if [ $? -eq 0 ]; then
        echo "[+] Anonymous access allowed for: $SHARE"
    else
        echo "[-] Access denied for: $SHARE"
    fi
done < "$WORDLIST"
```